<UserControl x:Class="QuizApp.WPF.Views.User.UserDashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Height="600" Width="800">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <TextBlock Grid.Row="0" Text="📊 Dashboard" FontSize="28" FontWeight="Bold" Foreground="#2C3E50" Margin="0,0,0,20"/>

            <!-- Loading Indicator -->
            <ProgressBar Grid.Row="1" Height="4" IsIndeterminate="True" 
                         Name="LoadingProgressBar"
                         Margin="0,0,0,20"/>

            <!-- Stats Cards -->
            <StackPanel Grid.Row="1" Orientation="Horizontal" Name="StatsPanel" Margin="0,0,0,20">
                <Border Background="White" Padding="20" Margin="0,0,15,0" Width="200">
                    <StackPanel>
                        <TextBlock Text="{Binding DashboardData.TotalAssignedQuizzes}" FontSize="32" FontWeight="Bold" Foreground="#4CAF50"/>
                        <TextBlock Text="Assigned Quizzes" FontSize="14" Foreground="#7F8C8D"/>
                    </StackPanel>
                </Border>

                <Border Background="White" Padding="20" Margin="0,0,15,0" Width="200">
                    <StackPanel>
                        <TextBlock Text="{Binding DashboardData.TotalCompletedQuizzes}" FontSize="32" FontWeight="Bold" Foreground="#2196F3"/>
                        <TextBlock Text="Completed Quizzes" FontSize="14" Foreground="#7F8C8D"/>
                    </StackPanel>
                </Border>

                <Border Background="White" Padding="20" Width="200">
                    <StackPanel>
                        <TextBlock Text="{Binding DashboardData.AverageScore, StringFormat={}{0}%}" FontSize="32" FontWeight="Bold" Foreground="#FF9800"/>
                        <TextBlock Text="Average Score" FontSize="14" Foreground="#7F8C8D"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Recent Results & Upcoming Quizzes -->
            <Grid Grid.Row="2" Margin="0,20,0,0" Name="ContentGrid">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Recent Results -->
                <Border Grid.Column="0" Background="White" Padding="20">
                    <StackPanel>
                        <TextBlock Text="📈 Recent Results" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>

                        <ItemsControl ItemsSource="{Binding DashboardData.RecentResults}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="#ECF0F1" BorderThickness="0,0,0,1" Padding="0,10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <TextBlock Text="{Binding QuizTitle}" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                                <TextBlock Text="{Binding TakenAt, StringFormat='MMM dd, yyyy'}" FontSize="11" Foreground="#7F8C8D"/>
                                            </StackPanel>

                                            <TextBlock Grid.Column="1" Text="{Binding Score, StringFormat={}{0}/{1}}" FontWeight="Bold" Foreground="#4CAF50" VerticalAlignment="Center"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <TextBlock Text="No recent results" Name="NoResultsText"
                                   HorizontalAlignment="Center" Foreground="#BDC3C7" FontStyle="Italic" Margin="0,20"/>
                    </StackPanel>
                </Border>

                <!-- Upcoming Quizzes -->
                <Border Grid.Column="2" Background="White" Padding="20">
                    <StackPanel>
                        <TextBlock Text="🕒 Upcoming Quizzes" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>

                        <ItemsControl ItemsSource="{Binding DashboardData.UpcomingQuizzes}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="#ECF0F1" BorderThickness="0,0,0,1" Padding="0,10">
                                        <StackPanel>
                                            <TextBlock Text="{Binding Title}" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                            <TextBlock Text="{Binding StartTime, StringFormat='MMM dd, yyyy - h:mm tt'}" FontSize="11" Foreground="#7F8C8D"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                        <TextBlock Text="No upcoming quizzes" Name="NoQuizzesText"
                                   HorizontalAlignment="Center" Foreground="#BDC3C7" FontStyle="Italic" Margin="0,20"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </ScrollViewer>
</UserControl>